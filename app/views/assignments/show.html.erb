<%= render 'organizations/organization_banner' %>

<%= render 'assignments/banner' %>

<div class="border-top border-bottom bg-white">
  <div class="container-lg p-responsive py-5">
    <% if @organization.roster %>
      <div class="Box">
        <div class="Box-header text-gray">
          <span id='students-tab' onclick="selectTab(this)" class="cursor selected mr-3" aria-current="page">All students</span>
          <span id='unlinked-tab' onclick="selectTab(this)" class="cursor">Unlinked GitHub accounts</span>
        </div>
      </div>

      <% if download_repositories_enabled? %>
        <%= render partial: 'shared/open_on_assistant_modal', locals: {
          assistant_url: assistant_organization_assignment_url,
          enabled: @assignment_repos.present?
        } %>
      <% end %>

        <span id='students-span'>
          <div class="assignment-repo-list">
            <% @roster_entries.each do |entry| %>
              <%= render partial: 'orgs/assignment_repos/assignment_repo', locals: {
                url: organization_assignment_roster_entry_path(@organization, @assignment, entry)
              } %>
            <% end %>
          </div>

          <%= render partial: 'shared/pagination', locals: { collection: @roster_entries, param_name: :students_page } %>
        </span>

      <span id='unlinked-span' class='hidden-tab'>
        <span>
          <% if @unlinked_users.empty? %>
            <%= render 'shared/unlinked_blank_slate' %>
          <% else %>
            <% @unlinked_user_repos.each do |repo| %>
              <% # Remove this unlinked_user thing later %>
              <%= render 'orgs/assignment_repos/unlinked_user', unlinked_user: repo.user, assignment_repo: repo %>
            <% end %>
          <% end %>
        </span>
        <%= render partial: 'shared/pagination', locals: { collection: @unlinked_user_repos, param_name: :unlinked_accounts_page } %>
      </span>
    <% else %>
      <% if @assignment_repos.present? %>
        <div class="assignment-repo-list">
          <% @assignment_repos.each do |assignment_repo| %>
            <%= render partial: 'orgs/assignment_repos/assignment_repo', locals: { url: organization_assignment_assignment_repo_path(@organization, @assignment, assignment_repo) } %>
          <% end %>
        </div>

        <%= render partial: 'shared/pagination', locals: { collection: @assignment_repos } %>
      <% else %>
        <div class="blankslate">
          <h3>"<%= @assignment.title %>" does not have any repositories.</h3>
          <p class="mb-0">Share the invitation link with your students to get started.</p>
        </div>
      <% end %>
    <% end %>
  </div>
</div>

<%= render partial: "shared/roster_tab_script" %>
